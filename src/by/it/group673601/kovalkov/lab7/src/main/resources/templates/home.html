<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
          integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

</head>
<style>
    .modal {
        overflow-y: auto;
    }
</style>
<body>
<div class="container" style="margin-top: 5%">
    <div class="row">
        <div class="col-md-4 offset-md-4">
            <div class="card">
                <div class="card-header">
                    Работа с клиентами
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-12">
                            <button class="btn btn-primary btn-block" data-toggle="modal" data-target="#addClient">
                                Добавить
                            </button>
                        </div>
                        <div class="col-md-12" style="margin-top: 5%">
                            <button class="btn btn-primary btn-block" data-toggle="modal" data-target="#removeClient">
                                Удалить
                            </button>
                        </div>
                        <div class="col-md-12" style="margin-top: 5%">
                            <button class="btn btn-primary btn-block" data-toggle="modal"
                                    data-target="#openEditingModal">
                                Отредактировать
                            </button>
                        </div>
                        <!--<div class="col-md-12" style="margin-top: 5%">-->
                        <!--<button class="btn btn-primary btn-block">Просмотреть всех</button>-->
                        <!--</div>-->
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="addClient" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Добавление клиента</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="form-group">
                        <label for="surname">Фамилия</label>
                        <input type="text" class="form-control" id="surname">
                    </div>
                    <div class="form-group">
                        <label for="name">Имя</label>
                        <input type="text" class="form-control" id="name">
                    </div>
                    <div class="form-group">
                        <label for="patronymic">Отчество</label>
                        <input type="text" class="form-control" id="patronymic">
                    </div>
                    <div class="form-group">
                        <label for="birthday">Дата рождения(dd-mm-yyyy)</label>
                        <input type="text" class="form-control" id="birthday">
                    </div>
                    <div class="form-group">
                        <label for="passportSerialNumber">Серийный номер пасспорта</label>
                        <input type="text" class="form-control" id="passportSerialNumber">
                    </div>
                    <div class="form-group">
                        <label for="passportNumber">Номер пасспорта</label>
                        <input type="text" class="form-control" id="passportNumber">
                    </div>
                    <div class="form-group">
                        <label for="whoGivePassport">Кем выдан</label>
                        <input type="text" class="form-control" id="whoGivePassport">
                    </div>
                    <div class="form-group">
                        <label for="passportGivenDate">Дата получения(dd-mm-yyyy)</label>
                        <input type="text" class="form-control" id="passportGivenDate">
                    </div>
                    <div class="form-group">
                        <label for="passportId">Идентификационный номер паспорта</label>
                        <input type="text" class="form-control" id="passportId">
                    </div>
                    <div class="form-group">
                        <label for="hometown">Место рождения</label>
                        <input type="text" class="form-control" id="hometown">
                    </div>
                    <div class="form-group">
                        <label for="currentCityLocation">Адрес фактического проживания</label>
                        <select class="custom-select" id="currentCityLocation">
                            <option value="MINSK" selected>Минск</option>
                            <option value="VITEBSK">Витебск</option>
                            <option value="GOMEL">Гомель</option>
                            <option value="MOGILEV">Могилев</option>
                            <option value="GRODNO">Гродно</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="address">Адрес</label>
                        <input type="text" class="form-control" id="address">
                    </div>
                    <div class="form-group">
                        <label for="homePhoneNumber">Домашний телефон</label>
                        <input type="text" class="form-control" id="homePhoneNumber">
                    </div>
                    <div class="form-group">
                        <label for="mobilePhone">Мобильный телефон</label>
                        <input type="text" class="form-control" id="mobilePhone">
                    </div>
                    <div class="form-group">
                        <label for="email">Электронная почта</label>
                        <input type="text" class="form-control" id="email">
                    </div>
                    <div class="form-group">
                        <label for="job">Место работы</label>
                        <input type="text" class="form-control" id="job">
                    </div>
                    <div class="form-group">
                        <label for="residenceAddress">Адрес прописки</label>
                        <input type="text" class="form-control" id="residenceAddress">
                    </div>
                    <div class="form-group">
                        <label for="maritalStatus">Семейное положение</label>
                        <select class="custom-select" id="maritalStatus">
                            <option value="UNMARRIED" selected>Не женат/не замужем</option>
                            <option value="DIVORCED">В разводе</option>
                            <option value="MARRIED">В браке</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="citizenship">Гражданство</label>
                        <select class="custom-select" id="citizenship">
                            <option value="BELARUS" selected>Беларус</option>
                            <option value="RUSSIAN">Россиянин</option>
                            <option value="UKRAINIAN">Украинец</option>
                            <option value="AMERICAN">Американец</option>
                            <option value="BRITISH">Британец</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="disability">Инвалидность</label>
                        <select class="custom-select" id="disability">
                            <option value="NONE" selected>Нет</option>
                            <option value="FIRST_GROUP">1 группа</option>
                            <option value="SECOND_GROUP">2 группа</option>
                            <option value="THIRD_GROUP">3 группа</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="monthlyIncome">Ежемесячный доход</label>
                        <input type="text" class="form-control" id="monthlyIncome">
                    </div>
                    <div class="form-group">
                        <label for="isRetiree">Пенсионер</label>
                        <input type="checkbox" id="isRetiree">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary btn-block" onclick="save()">Добавить</button>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="editClient" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Редактирование клиента</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="form-group">
                        <label for="surnameForEditing">Фамилия</label>
                        <input type="text" class="form-control" id="surnameForEditing">
                    </div>
                    <div class="form-group">
                        <label for="nameForEditing">Имя</label>
                        <input type="text" class="form-control" id="nameForEditing">
                    </div>
                    <div class="form-group">
                        <label for="patronymicForEditing">Отчество</label>
                        <input type="text" class="form-control" id="patronymicForEditing">
                    </div>
                    <div class="form-group">
                        <label for="birthdayForEditing">Дата рождения(dd-mm-yyyy)</label>
                        <input type="text" class="form-control" id="birthdayForEditing">
                    </div>
                    <div class="form-group">
                        <label for="passportSerialNumberForEditing">Серийный номер пасспорта</label>
                        <input type="text" class="form-control" id="passportSerialNumberForEditing">
                    </div>
                    <div class="form-group">
                        <label for="passportNumberForEditing">Номер пасспорта</label>
                        <input type="text" class="form-control" id="passportNumberForEditing">
                    </div>
                    <div class="form-group">
                        <label for="whoGivePassportForEditing">Кем выдан</label>
                        <input type="text" class="form-control" id="whoGivePassportForEditing">
                    </div>
                    <div class="form-group">
                        <label for="passportGivenDateForEditing">Дата получения(dd-mm-yyyy)</label>
                        <input type="text" class="form-control" id="passportGivenDateForEditing">
                    </div>
                    <div class="form-group">
                        <label for="passportIdForEditing">Идентификационный номер паспорта</label>
                        <input type="text" class="form-control" id="passportIdForEditing" readonly>
                    </div>
                    <div class="form-group">
                        <label for="hometownForEditing">Место рождения</label>
                        <input type="text" class="form-control" id="hometownForEditing">
                    </div>
                    <div class="form-group">
                        <label for="currentCityLocationForEditing">Адрес фактического проживания</label>
                        <select class="custom-select" id="currentCityLocationForEditing">
                            <option value="MINSK" selected>Минск</option>
                            <option value="VITEBSK">Витебск</option>
                            <option value="GOMEL">Гомель</option>
                            <option value="MOGILEV">Могилев</option>
                            <option value="GRODNO">Гродно</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="addressForEditing">Адрес</label>
                        <input type="text" class="form-control" id="addressForEditing">
                    </div>
                    <div class="form-group">
                        <label for="homePhoneNumberForEditing">Домашний телефон</label>
                        <input type="text" class="form-control" id="homePhoneNumberForEditing">
                    </div>
                    <div class="form-group">
                        <label for="mobilePhoneForEditing">Мобильный телефон</label>
                        <input type="text" class="form-control" id="mobilePhoneForEditing">
                    </div>
                    <div class="form-group">
                        <label for="emailForEditing">Электронная почта</label>
                        <input type="text" class="form-control" id="emailForEditing">
                    </div>
                    <div class="form-group">
                        <label for="jobForEditing">Место работы</label>
                        <input type="text" class="form-control" id="jobForEditing">
                    </div>
                    <div class="form-group">
                        <label for="residenceAddressForEditing">Адрес прописки</label>
                        <input type="text" class="form-control" id="residenceAddressForEditing">
                    </div>
                    <div class="form-group">
                        <label for="maritalStatusForEditing">Семейное положение</label>
                        <select class="custom-select" id="maritalStatusForEditing">
                            <option value="UNMARRIED" selected>Не женат/не замужем</option>
                            <option value="DIVORCED">В разводе</option>
                            <option value="MARRIED">В браке</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="citizenshipForEditing">Гражданство</label>
                        <select class="custom-select" id="citizenshipForEditing">
                            <option value="BELARUS" selected>Беларус</option>
                            <option value="RUSSIAN">Россиянин</option>
                            <option value="UKRAINIAN">Украинец</option>
                            <option value="AMERICAN">Американец</option>
                            <option value="BRITISH">Британец</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="disabilityForEditing">Инвалидность</label>
                        <select class="custom-select" id="disabilityForEditing">
                            <option value="NONE" selected>Нет</option>
                            <option value="FIRST_GROUP">1 группа</option>
                            <option value="SECOND_GROUP">2 группа</option>
                            <option value="THIRD_GROUP">3 группа</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="monthlyIncomeForEditing">Ежемесячный доход</label>
                        <input type="text" class="form-control" id="monthlyIncomeForEditing">
                    </div>
                    <div class="form-group">
                        <label for="isRetireeForEditing">Пенсионер</label>
                        <input type="checkbox" id="isRetireeForEditing">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary btn-block" onclick="edit()">Отредактировать</button>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="removeClient" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Удаление клиента</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="form-group">
                        <label for="passportIdForRemoving">Идентификационный номер пасспорта</label>
                        <input type="text" class="form-control" id="passportIdForRemoving">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary btn-block" onclick="remove()">Удалить</button>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="openEditingModal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Выбор клиента для редактирования</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="form-group">
                        <label for="passportIdForOpeningEditing">Идентификационный номер пасспорта</label>
                        <input type="text" class="form-control" id="passportIdForOpeningEditing">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary btn-block"
                        onclick="openForEditing()">Выбрать
                </button>
            </div>
        </div>
    </div>
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
        integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
        integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>
<script>
    $(document).ready(function () {
        var fn = function () {
            healthcheck();
            setTimeout(arguments.callee, 10000);
        };

        setTimeout(fn, 10000);
    });

    function healthcheck() {
        $.ajax({
            type: "GET",
            url: "/bank/status",
            success: function () {
                alert("Server is available");
            },
            error: function (error) {
                alert("Server is not available");
            }
        });
    }

    $('#editClient').on('shown.bs.modal', function () {
        $('#nameForEditing').trigger('focus');
    });

    function save() {
        var name = $("#name").val();
        var surname = $("#surname").val();
        var patronymic = $("#patronymic").val();
        var birthday = $("#birthday").val();
        var passportSerialNumber = $("#passportSerialNumber").val();
        var passportNumber = $("#passportNumber").val();
        var whoGivePassport = $("#whoGivePassport").val();
        var passportGivenDate = $("#passportGivenDate").val();
        var passportId = $("#passportId").val();
        var hometown = $("#hometown").val();
        var currentCityLocation = $("#currentCityLocation").val();
        var address = $("#address").val();
        var homePhoneNumber = $("#homePhoneNumber").val();
        var mobilePhone = $("#mobilePhone").val();
        var email = $("#email").val();
        var job = $("#job").val();
        var residenceAddress = $("#residenceAddress").val();
        var maritalStatus = $("#maritalStatus").val();
        var citizenship = $("#citizenship").val();
        var disability = $("#disability").val();
        var isRetiree = document.getElementById('isRetiree').checked;
        var monthlyIncome = $("#monthlyIncome").val();

        var client = {
            "surname": surname,
            "name": name,
            "patronymic": patronymic,
            "birthday": birthday,
            "passportSerialNumber": passportSerialNumber,
            "passportNumber": passportNumber,
            "whoGivePassport": whoGivePassport,
            "passportGivenDate": passportGivenDate,
            "passportId": passportId,
            "hometown": hometown,
            "currentCityLocation": currentCityLocation,
            "address": address,
            "homePhoneNumber": homePhoneNumber,
            "mobilePhone": mobilePhone,
            "email": email,
            "job": job,
            "residenceAddress": residenceAddress,
            "maritalStatus": maritalStatus,
            "citizenship": citizenship,
            "disability": disability,
            "isRetiree": isRetiree,
            "monthlyIncome": monthlyIncome
        };

        $.ajax({
            type: "POST",
            url: "/bank/add",
            contentType: "application/json",
            data: JSON.stringify(client),
            success: function () {
                alert("Сохранено");
                $('#addClient').modal('hide');
            },
            error: function (error) {
                alert(error.responseText);
            }
        });
    }

    function remove() {
        var id = $("#passportIdForRemoving").val();
        if (id === "") {
            alert("номер пасспорта не может быть пустым");
            return;
        }

        var url = "/bank/" + id + "/delete";

        $.ajax({
            type: "DELETE",
            url: url,
            success: function () {
                alert("Удалено");
                $('#removeClient').modal('hide');
            },
            error: function (error) {
                alert(error.responseText);
            }
        });
    }

    function edit() {
        var name = $("#nameForEditing").val();
        var surname = $("#surnameForEditing").val();
        var patronymic = $("#patronymicForEditing").val();
        var birthday = $("#birthdayForEditing").val();
        var passportSerialNumber = $("#passportSerialNumberForEditing").val();
        var passportNumber = $("#passportNumberForEditing").val();
        var whoGivePassport = $("#whoGivePassportForEditing").val();
        var passportGivenDate = $("#passportGivenDateForEditing").val();
        var passportId = $("#passportIdForEditing").val();
        var hometown = $("#hometownForEditing").val();
        var currentCityLocation = $("#currentCityLocationForEditing").val();
        var address = $("#addressForEditing").val();
        var homePhoneNumber = $("#homePhoneNumberForEditing").val();
        var mobilePhone = $("#mobilePhoneForEditing").val();
        var email = $("#emailForEditing").val();
        var job = $("#jobForEditing").val();
        var residenceAddress = $("#residenceAddressForEditing").val();
        var maritalStatus = $("#maritalStatusForEditing").val();
        var citizenship = $("#citizenshipForEditing").val();
        var disability = $("#disabilityForEditing").val();
        var isRetiree = document.getElementById('isRetireeForEditing').checked;
        var monthlyIncome = $("#monthlyIncomeForEditing").val();

        var client = {
            "surname": surname,
            "name": name,
            "patronymic": patronymic,
            "birthday": birthday,
            "passportSerialNumber": passportSerialNumber,
            "passportNumber": passportNumber,
            "whoGivePassport": whoGivePassport,
            "passportGivenDate": passportGivenDate,
            "passportId": passportId,
            "hometown": hometown,
            "currentCityLocation": currentCityLocation,
            "address": address,
            "homePhoneNumber": homePhoneNumber,
            "mobilePhone": mobilePhone,
            "email": email,
            "job": job,
            "residenceAddress": residenceAddress,
            "maritalStatus": maritalStatus,
            "citizenship": citizenship,
            "disability": disability,
            "isRetiree": isRetiree,
            "monthlyIncome": monthlyIncome
        };

        $.ajax({
            type: "PUT",
            url: "/bank/update",
            contentType: "application/json",
            data: JSON.stringify(client),
            success: function () {
                alert("Изменения сохранены");
                $('#editClient').modal('hide');
            },
            error: function (error) {
                alert(error.responseText);
            }
        });
    }

    function openForEditing() {

        var id = $("#passportIdForOpeningEditing").val();
        if (id === "") {
            alert("номер пасспорта не может быть пустым");
            return;
        }

        var url = "/bank/" + id + "/get";

        $.ajax({
            type: "GET",
            url: url,
            success: function (data) {
                $("#nameForEditing").val(data.name);
                $("#surnameForEditing").val(data.surname);
                $("#patronymicForEditing").val(data.patronymic);
                $("#birthdayForEditing").val(data.birthday);
                $("#passportSerialNumberForEditing").val(data.passportSerialNumber);
                $("#passportNumberForEditing").val(data.passportNumber);
                $("#whoGivePassportForEditing").val(data.whoGivePassport);
                $("#passportGivenDateForEditing").val(data.passportGivenDate);
                $("#passportIdForEditing").val(data.passportId);
                $("#hometownForEditing").val(data.hometown);
                $("#currentCityLocationForEditing").val(data.currentCityLocation);
                $("#addressForEditing").val(data.address);
                $("#homePhoneNumberForEditing").val(data.homePhoneNumber);
                $("#mobilePhoneForEditing").val(data.mobilePhone);
                $("#emailForEditing").val(data.email);
                $("#jobForEditing").val(data.job);
                $("#residenceAddressForEditing").val(data.residenceAddress);
                $("#maritalStatusForEditing").val(data.maritalStatus);
                $("#citizenshipForEditing").val(data.citizenship);
                $("#disabilityForEditing").val(data.disability);
                document.getElementById('isRetireeForEditing').checked = data.isRetiree === "true";
                $("#monthlyIncomeForEditing").val(data.monthlyIncome);

                $('#openEditingModal').modal('hide');
                $('#editClient').modal('show');
            },
            error: function (error) {
                alert(error.responseText);
            }
        });
    }
</script>
</body>
</html>